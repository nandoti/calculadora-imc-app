workflows:
    react-native-android:
        name: React Native Android
        max_build_duration: 120
        instance_type: mac_mini
        environment:
            vars:
                PACKAGE_NAME: "com.calculatorimc"
                CM_KEYSTORE: Encrypted(Z0FBQUFBQmdzQXBmTVZodzlOUjFCb2dfOXFqcWVNN3BvaTlOYnY5aVBQVTZnYUNvbjhMR0UybGUtX3F2dC1NUHdUZ2dJU2dVMVFlTjNleVlDa3AyTldQdDBsbHRhV2F5Vk5uY0REMnVPbGlnVkJDQk54d0IwY0c3X3dhcU81MzJWUjY2U2Exai1OU2RNU20wc1hyRFN6MzlSdGt5VzU1bS1JWFQ4RDE4R0c2TXRKM0FRa1Jib3gwTnRZQjRKZnc5TGh6WVp3SVZLR3hObUlsRFQwelprNzhsWlp6OU83UVJDMExhNWxkUC1uYkhKVVlUN09nV2o0STM5Vm4yQVBET2RSQWtKTm1BekZSMDJISHBEXzExM3ZjeDJCVndic0IwcVdiZFJlMUI0Qm45MWdTN05GcEJidGZ1T0xlTDgweDVUYndNSXZKYVJ5M0Z5em4tTFhKNngwd1pLNkY5Z3ZnRUJnSVZVR1lXNnRWb1gyVVlwUF9QMm9iX3FyRGJNNW42eHZPeENSTnFERUFMTm53aldySEdKOERaVnZFbUI1ODVld2paNTR1Nm81OV8xNUhqTEk1LVVtbTNBMm1BbWRBT0tyNVZheWtCN0NIMmZ3MnlYSjFiWUowYUZJVlE5VUN0UktoUExxZGlxbEFEWUx2T2RYeVl1eExpLVNYaVIwRWs1NHdLcEhscmhCYlpSVHEtTTNrcjY4cUU1V0pPVm9pTXU2dnJleWZLZDNsMVlmUUNoTC1xLVVSSmllYTJxN041dS1OTXBkZ0lMYWV0UWF1OTlHai16aHZaYUtyNUh5cFlpYklnX3dxX2ZxOWdoMVh5U2pjNmRVYVdpUUNWMUxia090Q0g1M3VoX2ozcDlwcVVlU3Jwa1htV0thM2ZPRy1jb3YzLTdwWnBsejY5aFZvZlc5QzllcEpuMW1XNW5ubDlUSUpQSEJUWWtsaUI2UFIxSjF6aGhKV2VTMGlBdFpxZ2J2UVcyODhwaGxWQVBSeTFZUjNnYkU1VUZzRFU4dGR2bk9qTm52NmJYTjloX2o3NmRiWGtxQlJNOG85VlNpSkRLcDB0c3k2QlhkOVVRMDRMVVY1aVo1S2VjMlY4RzBoOHkzSG1tRkQ5TWZFenpkWmZoaWU0bHNtQVp4NWFwNDZBQzZId0FFRlEtYzZuQnZETmt3QWROXzdNS0tuaEpvRFFtdUVpRGlCZHdQekQ3dHpwR1k4MWpsM0ZVSkJEb1g3RmpQNkN0SlBJQ1lkenlOalkySjZFT1g2S1JPNzZtWTdmNnlJVDFYeUhRZ251eDZrNWhTVXJhaTEzeDNEaTlyb0hRZDAtNXhKWXJDai15ckRlcGk0ajVDQko3N1czeEI4bkI5bnEtYTE4X2xaU19qUmprZHNQWXZwMUI2cTU5UFFjenU3ZzdRVzJ5dFJXb25GRy05djI0QUVFMmdPRjBQTlRTWEFOUjBpci1fNTBhSThoblJrRlBBWnk3VGY1ak5sQmZrQUI3aTJHM2FOZzlVaGQ5M2lwX2FXNDZZR2Q1YTZ4RXBaSXNuMXkwT2s1dVNONG5jQVFZNE44cGRMU2czQVVjQ1ZpekZvMkFJOW5POE5YV2wzelUzYnZyU2FYNkpvMWg2c1RMZFZrOFA0aWxERjBsMEZvOVNzY1ViYi1jdENoaU0xclRXdUVZcUxsVXlrODE4TnhYRlgxRU8wMmNxWE5XZE41QTJiVUIwal95bUtEZm90VFFlNUZ6WWlYdmdRX1pDck5QTWRxM3VCRm96QjZ3cFg1bjVBLTNQcW1sUHJBRGhiSmU4NGJIX1RTdDBYNTBwb19qaVVlYjZqQ2RlWlJ0ZDdITFBNMWREOUJ1cUQwSjExZmZGM2lVZnFKcEtiRmluS0h3dGhsVEQyVkg2aUUzQ0pmVU10SDlDOEc0SFc2YjZXQ29iV2IwZ3JlQnpSWEdacWVjLVB2dFVXUERoYlNsQzRyUnRBQ0dmZDFVWW10aU8xU1pab2xiQktFZ2hiekFuNkdnTHBtVm1KcEtQaXJmUHpVUVBvNDJVbFFqaXM0WWZQaDA0d2E0M2VUNzEzNWVLQkdyU1p2WWxGRHB4YzhDc1F0TUhqdzZfdnk5TEI5QWE4akNkLW9NdXhDX3FWRy1ubXdieTNFeDJQWGFfMUx1Z0Z0Wm1ieDhJWnNyQU9iN2ROUTZ1bDlkbE5jLXY5MVJ2bGxaVXU2d3VsbHN3d2t6MU9QOTlVbzVQTWdlUFN2cTFCNFRETUJLMElqZWJaYXpRWnJvZTdIM0NrNGNjR0F2WG5zMWpIdDMxVENNZHV2UWZrazRUZHEwaDlQTG9neHh0aFFObDNGWDhrM29PcXdDbzJsWlNQSG5GNXVJajhsaVluUGpFb0R3TnlsOEdEenR1d2gtUEpnQ2szZ1QzZ050eFB1cjN1Y3lhcDQ0WlJ4d2ZoaTVRYzdyVmZ1MGdTUkJ5ZzdqWDFYamEtbC1ERE1VaXdKc2thTWVrWnV2TENoVHFfeTlQWi1vbk5mR3RPMkFYU2lydHk5VG9GRnFZNHhSUGwtWlMxUHVfNlRsTVVQWDI3NGxrUnA4VHZ3bm1fQUNNOVBta2Y2dTJEYVhiTTZDZFdqa3FsUElyaWRrbEp0SmZaTE9hVWtuY05Sbm94UlFCZ3AtNTZSSGQ4Qm9Sa2ItellwUWZudmx1cl9TX3NDMjN1bGFhRm5pd2ZteDVRZENYZlJDUUNFenFWWXhCTlB3bS0yWDVpR2J2TlRmNTdiMHoxNlk4bnJZQU1JNnZjVGJsRmRVRDJqNlJ0S0hHQWxNRjVxYlB6aDlhMm1BSGc0VF93U3JyWXlFLW8tcl8wSXMzYTEzRUx1R05hVDVfWUgtYzVDUDhnbldPNWZoTlFCMjlhNTFmSEplYm5vZ1lSUml6VUhoMWRwMGlPMnZ5Z1JMV2VKTmZDcDBXTHNkdmFXZHBFZ1pRc3kzUldkemxvdnZVTlJUcVpWYmRCT25meGhzVXhsaXg2ZUh4a3gtamM3bUhFSEk3djdDd09CblpSSGp1ZnhuWTU5czI2c1JYQkxGdUw0Uzd5S0tYdnoxeE1VRWE4b3lpcDZPUTVSQTVVSDJ5bE5aV0EzRlZlX2FfMmhnSlMteXRHN2RoNHF6aXBoczBaZTNLQUhIdVFyWG9JQ3hHOVBweWlGcXNmdHcwU25Gb292TG5veTI1WHlEcXVBRi1rdVFZanEwNFpwRGFhM0REdUtabXR4R0NHSWVhM1ZCUkhZdEFEN2pCTUVFVHBtRTM0TVpjYmw1Sktha3FMY0ZDSHdEaVpJN2dlbTkxOUowQnlPMDN6eG9GSGpJS2RpbGtiU3BRb2V2cy0wU0JRUFBoNW5JaFRNWkpzWmtXai0zUWc1cjRMRnFpSGtxWGw0MkpVeFo4MFMydS14TVB1QnFOX0VaRFRLTE4xdFFXSm96bGhvdm9xM3NNcEZITU92TUVzYmJtRmNaZ00xNVZsLXR3Z25aWVNVNjhOWG1qcGdWcElDekNmRVlkdzJYV3FVY3ZMLUhycEZuYnd1X2w0T0dNSmY5UmJkVnFYQllKa0FiRENaV1FVZ0ZoTDFFczBIdHlKQi03YkVhcEVTT0c4V2ZMcVdjZXBLYlhNNnVZSUlSeXJrOWpsNm9ldEZSUWNjVnhOMXRBMnk5dFExeXBLbFV5OFBCMDRkQmNMQksyd1JYRkRJWVZQZjg2YWZaNENCdkNGZHdXNHY5bGNjRG02SlFQN3FJaHFLUlE1THluUkJxdU5qbmExWDcxVDMyeDZXUURGRmFkMVFmbmxPOGNjalJZYmxlc3d4a3FQOVFXYkk4UG5neTJudVdpOGlGYjBKZmZ4WG8wSWZRY3FxT3ZHd1FuLVByMURWWHNScERrQmNyNUo1SEdyMTE0dXJCQ0FSdVItWXFqQzAxM3VJbXZNWG5OYkhBRFBKYTkzdU9rb2w5VVl2OW9fZlUzSVJIS1JTZGdvVWNMR1MweFdhRjRhWG1YQ0FTT3llanQ4ZVQyVk9KdG11clptOWIzanJSV19ReTE2ZUR0MWRDUEFodFY4dWlORi1GZUROTzB0N1psdncyMFRTZUhjU3lSc0lHWDdrcnF5WXdxdXRiWUUyckxPbUx4UUhCZ1I3aDA3cTNKSlVRRUtnTHVHU3JnYS1IdU1sV2JScy1ZSmhiSUNjXzZjQlJLQWNkUkJPY19kZEpCcWpxVlBYbXFKZ1laOEg2YkI1RnVseGx3aERiTXVPUnZpVU5nM3FsXzNTUldndXJER19aOG00Rkc5cG1oZVFCNnE4ZkVlMmtSWXljYzhBcm5XQWdBc1p1YTJLSk1DOG5icV9lbXNVMVIyX3l2R1ByQlV1dS11VFV1R3ktUTdrTE5Pbl90cmk5M2ktcFhGMTVOMS1JYXg1eXkySVNyNjBUNHdDQlVfaGFIRmlndEJnMWNQcjQ0c3c0OHU5ZFRocXJUV3drTWRWT2lzN1J6VW9EYnVkVGlGalFCOHd1VXkwUWhOUnJxYXljYTVJQWw2Q3o3T0txUWp4X3BzMjVHdkl0TnVvTjNYSWhjcFMtUUFEYUdpcF8yaS1iSnhSMUFWbWRrbU0tUW1VSzhSN3NadjZHSGhkNVIxX2dGT0RHWldLQUs5eGd0YTlzUXJ1TjlUNXAzYzlscWR6eTJMellSbDVaTDlSblJnN0xsa2RLTElzb2tnZ1FmUU1ETGJXTEtJek8yT04wVUM5R2VDZVlyaXVzQWNRWHRzallncWhtREQtWnVLWEtibUdCYjY1TEF4NTB6RmNFOTFaZFdQUTRBdThkbGtFRm14dUY3dnlXcy1pM0ZLUzJ2R3pHNmFDamNWUWVyY0Z0SERuZDdxdmpDTTBkUzhkQUphSnk1M0cxVHI4cDFSTUJ5MkppVGlnUW80YWtJVDl1SnhNdzRxRGYtTFh5R25UTGRseUxaZUpROWplSkxtLUo2SUVjTVBsWHJ1UnRTdmk1Wm9Wc3FDOGx4N3dlXzBabThVR2x2eUMwTWJKTFh3ZVBpek9JUTNkOTlMYl91UXZzWnQtN2NuRkxkYkR0ZGhrOTNqYTZVYnZ4ckJKamxQX1VJNFZjbURHTTY3VUNJZnV0bWwtZnhQQ2lLbndpZnFwWlE0enUwNzc3V2xGSkQ2QzRoMUlta1l1Tk82dE9SRUNBZ29hS2hHaGJlMTVqT0tsVFhtVzdaMV95YnNLUEV2eWNNUDdMbVpNWE9taW01X0dlVy1JVWtJeTNQV3NuSEtPMGtvUDc1NDNCUmJUanlWWXpYdVRvLWotX0h4THc2WUdnMVRrTXFUYzhaTUVYSE5kRTdwUE9Ub081TF9HeGpmcm9lMFFzRlhsaU1ZbmU0UEdKNXhydFlnMWJQX0NVeUxCby1yQlNJMmdvaHdWMFZKSzd2bGNaZlc2VElvd0sydm9ibjZFb2tfbDZ4OWZOb1c5ZFFDYUpNMy01WVdld040UG44NHVxTmt5SjZDQndFaXVJZEVhbC1xXy03SHo0QU9IZzNPbFBSLUZiUjNkWHZjdXgyRm8zbV8zRU1tOThNMV9yMjhpazVUbk1yVnhDSEdiYnVBSmM3NUZLV3pDbmQwYTdoNWU5UFpmUG5ib2RrWDBwRExvelk2bUpMRnVCVmdJZ21yTUFYNEVqT2IyRkdWM1ctUWxLQ1pVQXVSakFNMXhPeEtVdzF6UkNrOTFNNmxRUVhoRE9aTGRIbnVJTFRhUUJ2UjMtVG4xOVJzTWpzNnkyYURCVERkdlVTQXlPZ0VvYVUxa3NvWjBtSmN6QTNZalkxejl0UkxXd2lQTld3TzFCcTl2Q0VzdGpZWVhzZU00UGpYcGdqV2JFS0dRVVc0d25CcUpQZ0RBYWRsWlBPOWFZZnhFVzFBODVqUVJPd20zRDF0Ui04YjJiSFFmdm5BbFFna3FiTE5ac0VDckJUQ253Y1ZDeU5YeXNtRzlna3VkcEo5RmdsbHBCTm1vWXgwZVQ4MU9sU1RyUmZWVmFFMjZXRlFQNGl4a1NIQmNfN3Y0OHFxSjhEeVN2QmYxT3Y0TGFpRFJGYlhDTWdwRXNxOFFPeFZVeXdJSkV6SkFOcVhPRHNhR05nLWg5VFBOMDZFYlJ5aGQwaS04dXdrc0dWWlVySlNFZnRhMUlfeTJUT0dFOWdkUkRabEVCQ2poZHVrd2F4ZTY1YWVDVFNKdmdWR0oxR1ROb0Y1WUpYV1huSkNWdTZPSjdiYlNSQThYUG9mZU5HSWNxM3hicG1ibEQzeGJ2R1AyLVNPb0k1RjBHYW1lWm1XaXpwblRaMzUyR3ljVzR3VllPdUd5VVBlLW45SXhuMFAzVVctaGI0RmI=)
                CM_KEYSTORE_PASSWORD: Encrypted(Z0FBQUFBQmdzQXF1TWU0cUlPT0lNY0s0R0d0UGdfRE1fOVMwSUdZVXBqTTFMa0UtQ3ptS3dEd1VmVTdFTHpfLUFjOXk1aUlReWQ4NFVEVTRQWkI0WnNLRFVkaWQ0UUR0Y0E9PQ==)
                CM_KEY_ALIAS_PASSWORD: Encrypted(Z0FBQUFBQmdzQXF1TWU0cUlPT0lNY0s0R0d0UGdfRE1fOVMwSUdZVXBqTTFMa0UtQ3ptS3dEd1VmVTdFTHpfLUFjOXk1aUlReWQ4NFVEVTRQWkI0WnNLRFVkaWQ0UUR0Y0E9PQ==)
                CM_KEY_ALIAS_USERNAME: Encrypted(Z0FBQUFBQmdzQXJVemJfVGo3S0FFeFQ3YWhGQXAzTUw2YWEwUUZVVnRMWG1lTTM5UVlYNjJBa2dvTkdsTWZtU2xRWlg4U3RlY2ItN2ZQcEk4MzljdFZtS1JqanpTSjRhcVE9PQ==)
                APP_CENTER_TOKEN: Encrypted(Z0FBQUFBQmd5Z2xESkFqbFFQQ2VldlItRGVhU0JEM1pjVFQ1Rmsyc0g0alA0ejI5MEczWks0WWJ6ZVJoWnZXUllVV2IwV0p2bjVZZGZ0MElueG93NEQtSmNGRVZ1QS1qeS1yN1pxWFRQYjBqa3VUV0gtNlZON28tdTZDWXNwcUJER1h5d1p6aDI2aXg=)
            node: latest
        scripts:
            - name: Install dependencies
              script: |
                    yarn install
            - name: Set Android SDK location
              script: |
                    echo "sdk.dir=$ANDROID_SDK_ROOT" > "$FCI_BUILD_DIR/android/local.properties"
            - name: Set up keystore
              script: |
                    echo $CM_KEYSTORE | base64 --decode > /tmp/keystore.keystore
                    cat >> "$FCI_BUILD_DIR/android/key.properties" <<EOF
                    storePassword=$CM_KEYSTORE_PASSWORD
                    keyPassword=$CM_KEY_ALIAS_PASSWORD
                    keyAlias=$CM_KEY_ALIAS_USERNAME
                    storeFile=/tmp/keystore.keystore
                    EOF                                   
            - name: Build Android release
              script: |
                cd android && ./gradlew assembleRelease
            - name: Upload apk for app center
              script: |
                echo 'Installing App Center CLI tools'
                npm install -g appcenter-cli
                
                echo "Publishing $apkPath to App Center"
                appcenter distribute release \
                    --group Collaborators \
                    --file android/app/build/outputs/apk/release/app-release.apk \
                    --release-notes 'App submission via Codemagic' \
                    --app luizhsouza/Calculadora-Imc \
                    --token "${APP_CENTER_TOKEN}" \
                    --quiet
        artifacts:
            - android/app/build/outputs/**/*.apk
        publishing:
          email:
            recipients:
              - henryque.souz4@gmail.com
            notify:
              success: true
              failure: false
